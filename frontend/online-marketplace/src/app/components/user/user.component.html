<div class="container">
    <!-- <app-logout></app-logout> -->
    <div class="user_data">
      <div *ngIf="user" class="flex-container">
        <div class="info-item">
          <span>user_id:</span>
          <span>{{ user._id }}</span>
        </div>
        <div class="info-item">
          <span>Username:</span>
          <span>{{ user.username }}</span>
        </div>
        <div class="info-item">
          <span>First Name:</span>
          <span>{{ user.firstname }}</span>
        </div>
        <div class="info-item">
          <span>Last Name:</span>
          <span>{{ user.lastname }}</span>
        </div>
        <div class="info-item">
          <span>Email:</span>
          <span>{{ user.email }}</span>
        </div>
        <div class="info-item">
          <span>Role:</span>
          <span>{{ user.role }}</span>
        </div>
        <div class="info-item">
          <span>Registration Date:</span>
          <span>{{ user.registrationDate | date }}</span>
        </div>
        <div class="info-item">
          <span>Balance:</span>
          <span>{{user.balance ?? "NOT_FOUND"}}</span>
        </div>
        <div class="info-item">
          <span>private inventory:</span>
          <span>{{user.preferences?.private_inventory ?? "not set"}}</span>
        </div>
      </div>
      <div *ngIf="!user" style="color: rgb(88, 20, 20);"> 
        NO USER INFORMATION FOUND
      </div>
        <form [formGroup] = "formGroup" class="add_money" action="">
            <label for="balance">add money</label>
            <input type="number" formControlName="addControl" style="display: inline;">
            <button (click)="addMoney()" >add</button>
        </form>
    </div>
    
    <div *ngIf="user" class="tabs">
      <mat-tab-group>
        <mat-tab label="Inventory">
          <app-filter-form [option]="option">
          </app-filter-form>
          <div *ngFor="let item of user.items">
              <app-item *ngIf="check(item)" [item]="item" [itemOnSale]="false">
              </app-item> 
              <div *ngIf="check(item)" class="sellButton">
                  <mat-form-field>
                      <mat-label>fill price to sell</mat-label>
                      <input type="number" matInput [(ngModel)]="item.price">
                  </mat-form-field>
                  <button style="width: 50px; height: 48px;" *ngIf="item.price" (click)="sell(item)" mat-raised-button color="primary">sell</button>
              </div>   
         </div>
        </mat-tab>
      
        <mat-tab label="Active Sell Offers" class="tab">
          <div *ngIf="user.transactions">
            <div *ngFor="let transaction of user.transactions">
              <div *ngIf="transaction.status === 'Active'" style="display: flex; align-items: center; flex-flow: column;">
                <app-transaction [transaction]="transaction"> </app-transaction>
                <button (click)="cancel(transaction)" style="max-width: 200px; position: relative;top: -25px" mat-raised-button color="primary">cancel offer</button>
              </div>
              
            </div>
          </div>
          <p *ngIf="!user.transactions"> 
            no active sell offers
          </p>
        </mat-tab>
      
        <mat-tab label="Transaction History" class="tab">
          <h2>Sold:</h2>
          <div *ngIf="user.transactions ">
            <div *ngFor="let transaction of user.transactions">
              <div *ngIf="transaction.status === 'Successful' && transaction.seller === user._id" style="display: flex; align-items: center; flex-flow: column;">
                <app-transaction [transaction]="transaction"> </app-transaction>
              </div>
            </div>
          </div>
          <p *ngIf="!user.transactions"> 
            no transaction in history
          </p>
          <h2>Bought:</h2>
          <div *ngIf="user.transactions ">
            <div *ngFor="let transaction of user.transactions">
              <div *ngIf="transaction.status === 'Successful' && transaction.buyer === user._id" style="display: flex; align-items: center; flex-flow: column;">
                <app-transaction [transaction]="transaction"> </app-transaction>
              </div>
            </div>
          </div>
        </mat-tab>
      </mat-tab-group>
    </div>
    
</div>
